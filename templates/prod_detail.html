{% extends 'base.html' %}
{% load static %}

{% block style %}
<link rel="stylesheet" href="{% static 'base/plugins/slick/slick.css' %}">
{% endblock %}

{% block content %}

<div class="main-wrapper">

    <!-- breadcrumb -->
    <nav class="bg-gray py-3">
        <div class="container">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">{{ product.title }}</li>
            </ol>
        </div>
    </nav>
    <!-- /breadcrumb -->

    <!-- PRODUCT SECTION -->
    <section class="product-detail-section">
        <div class="product-detail-container">
            <div class="product-detail-row">

                <!-- LEFT: PRODUCT IMAGE SLIDER -->
                <div class="col-lg-6 mb-4 mb-lg-0">

                    <!-- Main Slider -->
                    <div>
                        <div class="swiper productSwiper">
                            <div class="swiper-wrapper">
                                {% for img in product.images.all %}
                                <div class="swiper-slide">
                                    <img class="img-fluid" style="width:auto; object-fit: contain;"
                                        src="{{ img.image.url }}">
                                </div>
                                {% endfor %}
                            </div>

                        </div>
                        <div class="swiper-pagination"></div>

                        <div class="swiper-button-next swiper-button-next-cust"
                            style="top: 40%; background-color: transparent;"></div>
                        <div class="swiper-button-prev swiper-button-prev-cust"
                            style="top: 40%; background-color: transparent"></div>
                    </div>
                    <!-- Thumbnail Slider -->
                    <div class="swiper thumbSwiper mt-3">
                        <div class="swiper-wrapper">
                            {% for img in product.images.all %}
                            <div class="swiper-slide swiper-slide-mb" style="width: 30%;">
                                <img src="{{ img.image.url }}"
                                    style="height:80px; width:100px; object-fit:cover; border-radius:8px;">
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                </div>
                <!-- RIGHT: PRODUCT DETAILS -->
                <div class="col-lg-6">

                    <h2 class="product-title">{{ product.title }}</h2>

                    <!-- PRICE -->
                    <h3 class="text-primary mb-3">₹{{ product.price }}</h3>

                    <!-- SIZE + QUANTITY -->
                    <div class="product-actions">

                        <div class="row action-row">

                            <div class="col-12 col-sm-6 mb-3">
                                <label><strong>Select Size</strong></label>
                                <select class="form-control size-select" name="size">
                                    {% for s in product.sizes %}
                                    <option value="{{ s }}">{{ s }}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="col-12 col-sm-6 mb-3">
                                <label><strong>Quantity</strong></label>
                                <input type="number" class="form-control qty-input" min="1" value="1">
                            </div>

                        </div>

                        <a href="#quotationModal" data-toggle="modal" class="btn btn-primary quotation-btn">
                            Get Quotation
                        </a>
                    </div>

                    <!-- TABS -->
                    <ul class="prod-tabs">
                        <li class="active" data-tab="desc_tab">DESCRIPTION</li>
                        <li data-tab="dim_tab">DIMENSIONS</li>
                        <li data-tab="del_tab">DELIVERY</li>
                    </ul>

                    <div class="tab-content-box">

                        <!-- DESCRIPTION -->
                        <div id="desc_tab" class="tab-box active">
                            <p class="text-gray">{{ product.desc }}</p>
                        </div>

                        <!-- DIMENSIONS -->
                        <div id="dim_tab" class="tab-box">
                            <div class="dimension-row">
                                <span class="dimension-attribute">WIDTH</span>
                                <span>{{ product.width }} cm</span>
                            </div>
                            <div class="dimension-row">
                                <span class="dimension-attribute">DEPTH</span>
                                <span>{{ product.depth }} cm</span>
                            </div>
                            <div class="dimension-row">
                                <span class="dimension-attribute">HEIGHT</span>
                                <span>{{ product.height }} cm</span>
                            </div>
                        </div>

                        <!-- DELIVERY -->
                        <div id="del_tab" class="tab-box">
                            <p>Delivery usually takes 5–7 working days.</p>
                        </div>

                    </div>
                    <hr>
                    <!-- <div class="payment-option border border-primary mt-5 mb-4">
                        <h5 class="bg-white">Guaranted Safe Checkout</h5>
                        <img class="img-fluid w-100 p-3" src="{% static 'base/images/payment-card/all-card.png' %}" alt="payment-card">
                    </div> -->
                    <h5 class="mb-3">4 Great Reason to Buy From Us</h5>
                    <div class="row">
                        <!-- service item -->
                        <div class="col-lg-3 col-6 mb-4 mb-lg-0">
                            <div class="d-flex">
                                <i class="ti-truck icon-md mr-3"></i>
                                <div class="align-items-center">
                                    <h6>Free Shipping</h6>
                                </div>
                            </div>
                        </div>
                        <!-- service item -->
                        <div class="col-lg-3 col-6 mb-4 mb-lg-0">
                            <div class="d-flex">
                                <i class="ti-shield icon-md mr-3"></i>
                                <div class="align-items-center">
                                    <h6>Secure Payment</h6>
                                </div>
                            </div>
                        </div>
                        <!-- service item -->
                        <div class="col-lg-3 col-6 mb-4 mb-lg-0">
                            <div class="d-flex">
                                <i class="ti-money icon-md mr-3"></i>
                                <div class="align-items-center">
                                    <h6>Lowest Price</h6>
                                </div>
                            </div>
                        </div>
                        <!-- service item -->
                        <div class="col-lg-3 col-6 mb-4 mb-lg-0">
                            <div class="d-flex">
                                <i class="ti-reload icon-md mr-3"></i>
                                <div class="align-items-center">
                                    <h6>30 Days Return</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- QUOTATION MODAL -->
    <div class="modal fade" id="quotationModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content p-4">
                <h3>Request Quotation</h3>
                <p>Our team will contact you with the best price.</p>

                <a href="tel:+91XXXXXXXXXX" class="btn btn-primary w-100 mt-3">
                    Call Now
                </a>
            </div>
        </div>

    </div>


    <!-- TESTIMONIAL -->
    <section class="section bg-gray">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="mb-4">What Our Customers Think?</h3>
                </div>
                {% include 'partials/testimonials.html' %}
            </div>
        </div>
    </section>

    <!-- RELATED PRODUCTS -->
    <section class="collection-section">
        <h2 class="collection-heading">Top Collections</h2>
        <div class="collection-div">
            {% include 'partials/related_products.html' %}
        </div>
    </section>

</div>

{% endblock %}


{% block javascript %}

<script src="{% static 'base/plugins/slick/slick.min.js' %}"></script>

<script>
    // Related Products Slider
    var collectionSwiper = new Swiper(".collection-slider", {
        loop: true,
        speed: 600,
        grabCursor: true,
        centeredSlides: false,

        slidesPerView: 1,
        spaceBetween: 10,

        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },

        pagination: {
            el: ".swiper-pagination",
            clickable: true,
            dynamicBullets: true,
        },

        breakpoints: {
            480: { slidesPerView: 1, spaceBetween: 20 },
            640: { slidesPerView: 2, spaceBetween: 22 },
            992: { slidesPerView: 4, spaceBetween: 24 },
            1400: { slidesPerView: 4, spaceBetween: 30 }
        }
    });

    // Product Tabs
    document.querySelectorAll(".prod-tabs li").forEach(tab => {
        tab.addEventListener("click", function () {
            document.querySelectorAll(".prod-tabs li").forEach(t => t.classList.remove("active"));
            this.classList.add("active");

            let tabId = this.getAttribute("data-tab");

            document.querySelectorAll(".tab-box").forEach(box => box.classList.remove("active"));
            document.getElementById(tabId).classList.add("active");
        });
    });

    // Product + Thumbnail Slider
    var thumbSwiper = new Swiper(".thumbSwiper", {
        slidesPerView: 4,
        spaceBetween: 10,
        watchSlidesProgress: true,
    });

    var productSwiper = new Swiper(".productSwiper", {
        spaceBetween: 10,
        loop: true,
        speed: 600,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        thumbs: {
            swiper: thumbSwiper,
        },
    });
</script>

{% endblock %}